<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Documentation</title>
      <link href="/styles.css" rel="stylesheet" />
   </head>
   <body>
      <div style="display: flex; flex: 1">
        <aside>
          <h2>Contents</h2>
          <ul>
             <li>
                <a href="/topics/getting-started">
                   <h3>Getting Started</h3>
                </a>
             </li>
             <li>
                <a href="/topics/file-formats.html">
                   <h3>File Formats</h3>
                </a>
                <ul>
                   <li><a href="/topics/file-formats#JBIN">JBIN (would link to the header/section)</a></li>
                </ul>
             </li>
             <li>
                <a href="/topics/database-usage.html">
                   <h3>Database Usage</h3>
                </a>
             </li>
             <li>
                <a href="/topics/transforming-data.html"
                   >
                   <h3>Transforming Data</h3>
                </a>
             </li>
             <li>
                <a href="/topics/filtering-data.html">
                   <h3>Filtering Data</h3>
                </a>
             </li>
             <li>
                <a href="/topics/Contact.html">
                   <h3>Contact</h3>
                </a>
             </li>
          </ul>
       </aside>
         <!-- Main Content -->
         <main>

            <section id="formats" class="mb-12">
               <h2>Getting Started</h2>
               <p>
                  Convirgance provides flexibility with a variaty of file formats, JSON, CSV along with JBIN. Its simple to convert from one format to another.
               </p>
               <table border="1">
                  <thead>
                     <tr>
                        <th>Format</th>
                        <th>Description</th>
                        <th>Read/Write</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr>
                        <td>CSV</td>
                        <td>Comma-separated values, widely used for tabular data.</td>
                        <td>Read/Write</td>
                     </tr>
                     <tr>
                        <td>JSON</td>
                        <td>JavaScript Object Notation, common for structured data.</td>
                        <td>Read/Write</td>
                     </tr>
                     <tr>
                        <td>SQL</td>
                        <td>Structured Query Language, for relational databases.</td>
                        <td>Read/Write</td>
                     </tr>
                     <tr>
                        <td>Excel (TBD)</td>
                        <td>Microsoft Excel spreadsheets (.xls, .xlsx).</td>
                        <td>Read/Write</td>
                     </tr>
                     <tr>
                        <td>Parquet (TBD)</td>
                        <td>Columnar storage file format for big data applications.</td>
                        <td>Read/Write</td>
                     </tr>
                  </tbody>
               </table>
            </section>
            <section id="file-formats" class="mb-12">
               <h2>Extending the Input Interface</h2>
               <p>Convirgance provides an extensible input interface to allow developers to integrate support for new data formats. By implementing the <code>Input</code> interface, developers can define custom readers for various formats. Below is an example implementation for handling CSV files:</p>
               <h3>Example: CSVInput Implementation</h3>
               <pre>
<code>/**
  * An implementation of the Input interface to handle CSV files.
  */
public class CSVInput implements Input<JSONObject>
{
    @Override
    public JSONObject read(String filePath) throws IOException
    {
        JSONObject row;
        JSONObject result = new JSONObject();
        String[] values;

        try (BufferedReader br = new BufferedReader(new FileReader(filePath)))
        {
            String line;
            String[] headers = null;

            // Read CSV line by line
            while ((line = br.readLine()) != null)
            {
                values = line.split(",");
                if (headers == null)
                {
                    headers = values;
                }
                else
                {
                    row = new JSONObject();

                    for (int i = 0; i < headers.length; i++)
                    {
                      row.put(headers[i], values[i]);
                    }

                    result.append("rows", row);
                }
            }
        }
        return result;
    }
}
</code></pre>
               <h3>Steps to Add Support for Other Formats</h3>
               <ol>
                  <li><strong>Implement the Input Interface:</strong> Create a class implementing <code>Input&lt;T&gt;</code>, where <code>T</code> is the desired output type, such as <code>JSONObject</code>.</li>
                  <li><strong>Handle File Reading Logic:</strong> Write the logic to parse the specific file format and convert the data into the desired structure.</li>
               </ol>
               <h3>Best Practices</h3>
               <ul>
                  <li>Ensure robust error handling to deal with malformed files.</li>
                  <li>Optimize performance for large files by using streaming approaches where applicable.</li>
               </ul>
               <p>By following these steps, Convirgance can easily accommodate support for new and custom file formats.</p>
               <h2>Extending the Output Interface</h2>
               <p>Convirgance also allows developers to extend its output interface for supporting additional file formats. By implementing the <code>Output</code> interface, you can define custom writers to generate files in new formats. Below is an example implementation for handling CSV output:</p>
               <h3>Example: CSVOutput Implementation</h3>
               <pre><code>/**
  * An implementation of the Output interface to handle CSV file writing.
  */
public class CSVOutput implements Output<JSONObject>
{
    @Override
    public void write(String filePath, JSONObject data) throws IOException
    {
        try (BufferedWriter bw = new BufferedWriter(new FileWriter(filePath)))
        {
            JSONArray rows = data.getJSONArray("rows");
            JSONObject firstRow;
            JSONObject row;
            String line;

            // Write headers
            if (rows.length() > 0) {
                firstRow = rows.getJSONObject(0);
                String headers = String.join(",", firstRow.keySet());
                bw.write(headers);
                bw.newLine();
            }

            // Write data rows
            for (int i = 0; i < rows.length(); i++) {
                row = rows.getJSONObject(i);

                line = row.keySet().stream()
                    .map(key -> row.optString(key, ""))
                    .collect(Collectors.joining(","));

                bw.write(line);
                bw.newLine();
            }
        }
    }
}
</code></pre>
               <h3>Steps to Add Support for Other Output Formats</h3>
               <ol>
                  <li><strong>Implement the Output Interface:</strong> Create a class implementing <code>Output&lt;T&gt;</code>, where <code>T</code> is the input type for writing data (e.g., <code>JSONObject</code>).</li>
                  <li><strong>Handle File Writing Logic:</strong> Write the logic to convert the input data structure into the desired file format.</li>
               </ol>
               <h3>Best Practices</h3>
               <ul>
                  <li>Ensure proper escaping of special characters (e.g., commas, quotes) in CSV files.</li>
                  <li>Validate input data to match format-specific requirements.</li>
                  <li>Optimize performance for writing large files by using buffered output streams.</li>
               </ul>
               <p>By implementing the output interface, Convirgance can easily support writing files in new and custom formats.</p>
            </section>
            <section id="Delimited" class="mb-12">
               <h3>Delimited Files</h3>
               <pre>
<code>import com.convirgance.Convirgance;
public class Demo
{
    private static DataSource source;

    public static void main(String[] args)
    {
        DBMS dbms = new DBMS(source);
        Iterable<JSONObject> results = dbms.query(new Query("select * from CUSTOMER"));
        String[] fields = new String[]{"Names", "Device Count", "Dependents"};

        // This will delimit the content with '?' using only the provided headers
        DelimitedOutput input = new DelimitedOutput(fields, "?");

        ByteArrayTarget target = new ByteArrayTarget();

        // Write out the results with only the three fields.
        output.write(target, audience);
    }
}</code></pre>
            </section>
            <section id="json" class="mb-12">
               <h3>JSON</h3>
               <pre><code>import com.convirgance.Convirgance;
public class Demo
{
    private static DataSource source;

    public static void main(String[] args)
    {
        source = new FileSource(new File(filename));
        input = new JSONInput().read(source);

        ByteArrayTarget target = new ByteArrayTarget();

        // Write out the results with only the three fields.
        output.write(target, audience);
    }
}</code></pre>
            </section>
            <section id="csv" class="mb-12">
               <h3>CSV</h3>
               <pre><code>import com.convirgance.Convirgance;
public class Demo
{
    public static void main(String[] args)
    {
      ByteArrayTarget target = new ByteArrayTarget();

      CSVOutput output = new CSVOutput();
      try(OutputCursor cursor = output.write(target))
      {
          cursor.write(new JSONArray("[{\"name\":\"John\",\"quote\":\"His favorite quote is \\\"Hello World\\\"\"},{\"name\":\"Alice\",\"quote\":\"She said \\\"Hi\\\"\"}]"));
      }
    }
  }</code></pre>
            </section>
            <section id="jbin" class="mb-12">
               <h3>JBIN</h3>
               <pre><code>import com.convirgance.Convirgance;
public class Demo
{
    private static DataSource source;

    public static void main(String[] args)
    {
      DBMS dbms = new DBMS(source);
      Iterable<JSONObject> results = dbms.query(new Query("select * from CUSTOMER"));
      ByteArrayTarget target = new ByteArrayTarget();
      JBINInput input = new JBINInput();
      JBINOutput output = new JBINOutput();

      try(OutputCursor cursor = output.write(target))
      {
          cursor.write(results);
      }
    }
  }</code></pre>
            </section>
         </main>
      </div>
   </body>
</html>
